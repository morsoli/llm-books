## OpenAI æ–‡æ¡£è§£è¯»
OpenAI æ–‡æ¡£æ¶‰åŠå†…å®¹ä¼—å¤šï¼Œè€Œä¸”è¿™é‡Œå·²ç»æœ‰äº†[ä¸­æ–‡ç¿»è¯‘](https://openai.xiniushu.com/)ï¼Œéœ€è¦è¯¦ç»†äº†è§£çš„å¯ä»¥è‡ªè¡Œå‰å¾€é˜…è¯»ã€‚æˆ‘è¿™é‡Œä¼šé‡ç‚¹é€‰å–é«˜é¢‘ä½¿ç”¨çš„ API è¿›è¡Œè¯´æ˜ä»¥åŠå¯¹Fine-tuningï¼ˆå¾®è°ƒï¼‰ã€Embeddingsï¼ˆåµŒå…¥ï¼‰ã€GPT best practicesï¼ˆGPTæœ€ä½³å®è·µï¼‰å‡ ä¸ªä¸»é¢˜è¿›è¡Œè§£è¯»ã€‚

### APIä»‹ç»
1. æ‰€æœ‰ API æ¼”ç¤ºå‡ä½¿ç”¨ Python ä»£ç ä½œä¸ºç¤ºä¾‹ï¼Œæ‰€ä»¥ç¡®ä¿å·²ç»å®‰è£…å®˜æ–¹ Python åŒ…ï¼š`pip install openai`ï¼ŒåŒæ—¶é…ç½® API å¯†é’¥çš„ç¯å¢ƒå˜é‡ `OPENAI_API_KEY`ã€‚
2. è®¤è¯ï¼šOpenAI API ä½¿ç”¨ API å¯†é’¥è¿›è¡Œèº«ä»½éªŒè¯ï¼Œ [APIå¯†é’¥é¡µé¢](https://platform.openai.com/account/api-keys)å¯ä»¥è·å–ä½¿ç”¨çš„ API å¯†é’¥ã€‚é™¤äº†å¯†é’¥ï¼Œå¯¹äºå±äºå¤šä¸ªç»„ç»‡çš„ç”¨æˆ·ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªRequesting organizationå­—æ®µï¼ˆå¯ä»¥åœ¨[ç»„ç»‡è®¾ç½®](https://platform.openai.com/account/org-settings)é¡µé¢ä¸Šæ‰¾åˆ°ç»„ç»‡IDï¼‰æ¥æŒ‡å®šç”¨äº APIè¯·æ±‚çš„ç»„ç»‡ï¼Œè¿™äº›APIè¯·æ±‚çš„ä½¿ç”¨å°†è®¡å…¥æŒ‡å®šç»„ç»‡çš„è®¢é˜…é…é¢ã€‚

    ```python
    import os
    import openai
    # openai.organization = "org-gth0C8mT2wnKealyDkrSrpQk"
    openai.api_key = os.getenv("OPENAI_API_KEY")
    openai.Model.list()
    ```

#### Chat Completions ä¼šè¯è¡¥å…¨
è¿™ä¸ªæ˜¯ä½¿ç”¨é¢‘æ¬¡æœ€é«˜çš„æ¥å£ï¼Œå‡ ä¹å½“å‰æ‰€æœ‰çš„å¥—å£³ChatGPTåº”ç”¨éƒ½æ˜¯åŸºäºè¿™ä¸ªæ¥å£å°è£…çš„ï¼Œæ‰€ä»¥å°†å…¶æ”¾åœ¨ç¬¬ä¸€ä¸ªã€‚ç»™å®šä¸€ç»„æè¿°å¯¹è¯çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œæ¨¡å‹å°†è¿”å›ä¸€ä¸ªå›å¤ã€‚
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")

# https://api.openai.com/v1/chat/completions
completion = openai.ChatCompletion.create(
  model="gpt-3.5-turbo",
  messages=[
    {"role": "user", "content": "Hello!"}
  ]
)

print(completion.choices[0].message)
```

**å“åº”** ï¼š
```json
{
  "id": "chatcmpl-123",
  "object": "chat.completion",
  "created": 1677652288,
  "choices": [{
    "index": 0,
    "message": {
      "role": "assistant",
      "content": "\n\nHello there, how may I assist you today?",
    },
    "finish_reason": "stop"
  }],
  "usage": {
    "prompt_tokens": 9,
    "completion_tokens": 12,
    "total_tokens": 21
  }
}
```

**Request body(å¸¸ç”¨å…¥å‚è¯¦è§£)** ï¼š

> - **`model` ï¼ˆstringï¼Œå¿…å¡«ï¼‰**
>
>   è¦ä½¿ç”¨çš„æ¨¡å‹IDã€‚æœ‰å…³å“ªäº›æ¨¡å‹é€‚ç”¨äºChat APIçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ [æ¨¡å‹ç«¯ç‚¹å…¼å®¹æ€§è¡¨](https://platform.openai.com/docs/models/model-endpoint-compatibility)
>
> - **`messages` ï¼ˆarrayï¼Œå¿…å¡«ï¼‰**
>
>   è¿„ä»Šä¸ºæ­¢æè¿°å¯¹è¯çš„æ¶ˆæ¯åˆ—è¡¨
>
>   - **`role` ï¼ˆstringï¼Œå¿…å¡«ï¼‰**
>
>     å‘é€æ­¤æ¶ˆæ¯çš„è§’è‰²ã€‚`system` ã€`user` æˆ– `assistant` ä¹‹ä¸€ï¼ˆä¸€èˆ¬ç”¨ user å‘é€ç”¨æˆ·é—®é¢˜ï¼Œsystem å‘é€ç»™æ¨¡å‹æç¤ºä¿¡æ¯ï¼‰
>
>   - **`content` ï¼ˆstringï¼Œå¿…å¡«ï¼‰**
>
>     æ¶ˆæ¯çš„å†…å®¹
>
>   - **`name` ï¼ˆstringï¼Œé€‰å¡«ï¼‰**
>
>     æ­¤æ¶ˆæ¯çš„å‘é€è€…å§“åã€‚å¯ä»¥åŒ…å« a-zã€A-Zã€0-9 å’Œä¸‹åˆ’çº¿ï¼Œæœ€å¤§é•¿åº¦ä¸º 64 ä¸ªå­—ç¬¦
>
> - **`stream` ï¼ˆbooleanï¼Œé€‰å¡«ï¼Œæ˜¯å¦æŒ‰æµçš„æ–¹å¼å‘é€å†…å®¹ï¼‰**
>
>   å½“å®ƒè®¾ç½®ä¸º true æ—¶ï¼ŒAPI ä¼šä»¥ SSEï¼ˆ Server Side Event ï¼‰æ–¹å¼è¿”å›å†…å®¹ã€‚SSE æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé•¿é“¾æ¥ï¼Œä¼šæŒç»­ä¸æ–­åœ°è¾“å‡ºå†…å®¹ç›´åˆ°å®Œæˆå“åº”ã€‚å¦‚æœä¸æ˜¯åšå®æ—¶èŠå¤©ï¼Œé»˜è®¤falseå³å¯ã€‚è¯·å‚è€ƒOpenAI Cookbook ä»¥è·å– [ç¤ºä¾‹ä»£ç ](https://github.com/openai/openai-cookbook/blob/main/examples/How_to_stream_completions.ipynb)ã€‚
>
> - **`max_tokens` ï¼ˆintegerï¼Œé€‰å¡«ï¼‰**
>
>   åœ¨èŠå¤©è¡¥å…¨ä¸­ç”Ÿæˆçš„æœ€å¤§ [tokens](https://platform.openai.com/tokenizer) æ•°ã€‚
>
>   è¾“å…¥tokenå’Œç”Ÿæˆçš„tokençš„æ€»é•¿åº¦å—æ¨¡å‹ä¸Šä¸‹æ–‡é•¿åº¦çš„é™åˆ¶ã€‚
>
> - **`temperature` ï¼ˆnumberï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯ 1ï¼‰**
>
>   é‡‡æ ·æ¸©åº¦ï¼Œåœ¨ 0å’Œ 2 ä¹‹é—´ã€‚
>
>   è¾ƒé«˜çš„å€¼ï¼Œå¦‚0.8ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼Œå¦‚0.2ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚
>
>   é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ`temperature` ï¼‰æˆ–è€… `top_p` ï¼Œä½†ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼ŒäºŒé€‰ä¸€ã€‚
>


#### Completions ï¼ˆæ–‡æœ¬å’Œä»£ç ï¼‰è¡¥å…¨
ç»™å®šä¸€ä¸ªæç¤ºï¼Œæ¨¡å‹å°†è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªé¢„æµ‹çš„è¡¥å…¨ï¼Œå¹¶ä¸”è¿˜å¯ä»¥åœ¨æ¯ä¸ªä½ç½®è¿”å›æ›¿ä»£ token çš„æ¦‚ç‡ã€‚
  ```python
  import os
  import openai
  openai.api_key = os.getenv("OPENAI_API_KEY")
  # https://api.openai.com/v1/completions
  openai.Completion.create(
    model="text-davinci-003",
    prompt="Say this is a test",
    max_tokens=7,
    temperature=0
  )
```

**å“åº”** ï¼š
```json
  "id": "cmpl-uqkvlQyYK7bGYrRHQ0eXlWi7",
  "object": "text_completion",
  "created": 1589478378,
  "model": "text-davinci-003",
  "choices": [
    {
      "text": "\n\nThis is indeed a test",
      "index": 0,
      "logprobs": null,
      "finish_reason": "length"
    }
  ],
  "usage": {
    "prompt_tokens": 5,
    "completion_tokens": 7,
    "total_tokens": 12
  }
}
```

**Request body(å…¥å‚è¯¦è§£)** ï¼š

> - **`model` ï¼ˆstringï¼Œå¿…å¡«ï¼‰**
>
>   è¦ä½¿ç”¨çš„æ¨¡å‹çš„ IDã€‚å¯ä»¥å‚è€ƒ [æ¨¡å‹ç«¯ç‚¹å…¼å®¹æ€§è¡¨](https://platform.openai.com/docs/models/model-endpoint-compatibility)
>
> - **`prompt` ï¼ˆstring or arrayï¼Œé€‰å¡«ï¼ŒDefaults to <|endoftext|>ï¼‰**
>
>   ç”Ÿæˆè¡¥å…¨çš„æç¤ºï¼Œç¼–ç ä¸ºå­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²æ•°ç»„ã€tokenæ•°ç»„æˆ–tokenæ•°ç»„æ•°ç»„ã€‚
>
>   æ³¨æ„ <|endoftext|> æ˜¯æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çœ‹åˆ°çš„æ–‡æ¡£åˆ†éš”ç¬¦ï¼Œæ‰€ä»¥å¦‚æœæ²¡æœ‰æŒ‡å®šæç¤ºç¬¦ï¼Œæ¨¡å‹å°†åƒä»æ–°æ–‡æ¡£çš„å¼€å¤´ä¸€æ ·ç”Ÿæˆã€‚
>
> - **`stream` ï¼ˆbooleanï¼Œé€‰å¡«ï¼Œé»˜è®¤ falseï¼‰**
>
>   å½“å®ƒè®¾ç½®ä¸º true æ—¶ï¼ŒAPI ä¼šä»¥ SSEï¼ˆ Server Side Event ï¼‰æ–¹å¼è¿”å›å†…å®¹ï¼Œå³ä¼šä¸æ–­åœ°è¾“å‡ºå†…å®¹ç›´åˆ°å®Œæˆå“åº”ï¼Œæµé€šè¿‡ `data: [DONE]` æ¶ˆæ¯ç»ˆæ­¢ã€‚
>
> - **`max_tokens` ï¼ˆintegerï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯ 16ï¼‰**
>
>   è¡¥å…¨æ—¶è¦ç”Ÿæˆçš„æœ€å¤§ [token](https://platform.openai.com/tokenizer) æ•°ã€‚
>
>   æç¤º `max_tokens` çš„ token è®¡æ•°ä¸èƒ½è¶…è¿‡æ¨¡å‹çš„ä¸Šä¸‹æ–‡é•¿åº¦ã€‚å¤§å¤šæ•°æ¨¡å‹çš„ä¸Šä¸‹æ–‡é•¿åº¦ä¸º 2048 ä¸ªtokenï¼ˆæœ€æ–°æ¨¡å‹é™¤å¤–ï¼Œå®ƒæ”¯æŒ 4096ï¼‰
>
> - **`temperature` ï¼ˆnumberï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯1ï¼‰**
>
>   ä½¿ç”¨å“ªä¸ªé‡‡æ ·æ¸©åº¦ï¼Œåœ¨ **0å’Œ2ä¹‹é—´**ã€‚
>
>   è¾ƒé«˜çš„å€¼ï¼Œå¦‚0.8ä¼šä½¿è¾“å‡ºæ›´éšæœºï¼Œè€Œè¾ƒä½çš„å€¼ï¼Œå¦‚0.2ä¼šä½¿å…¶æ›´åŠ é›†ä¸­å’Œç¡®å®šæ€§ã€‚
>
>   é€šå¸¸å»ºè®®ä¿®æ”¹è¿™ä¸ªï¼ˆ`temperature` ï¼‰æˆ– `top_p` ä½†ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼ŒäºŒé€‰ä¸€ã€‚
>
> - **`n` ï¼ˆintegerï¼Œé€‰å¡«ï¼Œé»˜è®¤ä¸º 1ï¼‰**
>
>   æ¯ä¸ª `prompt` ç”Ÿæˆçš„è¡¥å…¨æ¬¡æ•°ã€‚
>
>   æ³¨æ„ï¼šç”±äºæ­¤å‚æ•°ä¼šç”Ÿæˆè®¸å¤šè¡¥å…¨ï¼Œå› æ­¤å®ƒä¼šå¿«é€Ÿæ¶ˆè€—tokené…é¢ã€‚å°å¿ƒä½¿ç”¨ï¼Œå¹¶ç¡®ä¿å¯¹ `max_tokens` å’Œ `stop` è¿›è¡Œåˆç†çš„è®¾ç½®ã€‚
>


#### <a id="embeddings">Embeddings åµŒå…¥</a>
å°†ä¸€ä¸ªç»™å®šè¾“å…¥è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œæä¾›ç»™æœºå™¨å­¦ä¹ æ¨¡å‹ç®—æ³•ä½¿ç”¨ã€‚
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/embeddings
openai.Embedding.create(
  model="text-embedding-ada-002",
  input="The food was delicious and the waiter..."
)
```

**å“åº”** ï¼š
```json
{
  "object": "list",
  "data": [
    {
      "object": "embedding",
      "embedding": [
        0.0023064255,
        -0.009327292,
        .... (1536 floats total for ada-002)
        -0.0028842222,
      ],
      "index": 0
    }
  ],
  "model": "text-embedding-ada-002",
  "usage": {
    "prompt_tokens": 8,
    "total_tokens": 8
  }
}
```

**Request body(å…¥å‚è¯¦è§£)** ï¼š

> - **`model` ï¼ˆstringï¼Œå¿…å¡«ï¼‰**
>
>   è¦ä½¿ç”¨çš„ **æ¨¡å‹ID**ï¼Œå¯ä»¥å‚è€ƒ [æ¨¡å‹ç«¯ç‚¹å…¼å®¹æ€§è¡¨](https://platform.openai.com/docs/models/model-endpoint-compatibility)
>
> - **`input` ï¼ˆstring or arrayï¼Œå¿…å¡«ï¼‰**
>
>   è¾“å…¥æ–‡æœ¬ä»¥è·å–åµŒå…¥ï¼Œç¼–ç ä¸ºå­—ç¬¦ä¸²æˆ–tokenæ•°ç»„ã€‚è¦åœ¨å•ä¸ªè¯·æ±‚ä¸­è·å–å¤šä¸ªè¾“å…¥çš„åµŒå…¥ï¼Œè¯·ä¼ é€’å­—ç¬¦ä¸²æ•°ç»„æˆ–tokenæ•°ç»„çš„æ•°ç»„ã€‚æ¯ä¸ªè¾“å…¥é•¿åº¦**ä¸å¾—è¶…è¿‡ 8192 ä¸ªtoken**ã€‚
>
> - **`user` ï¼ˆstringï¼Œé€‰å¡«ï¼‰**
>
>   ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä»£è¡¨ç»ˆç«¯ç”¨æˆ·ï¼Œå¯ä»¥å¸®åŠ©OpenAIæ£€æµ‹æ»¥ç”¨ã€‚
>

#### Fine-tuning å¾®è°ƒ
ä½¿ç”¨è‡ªå®šä¹‰çš„ç‰¹å®šè®­ç»ƒæ•°æ®ï¼Œå®šåˆ¶è‡ªå·±çš„æ¨¡å‹ã€‚
##### **Create fine-tune**
åˆ›å»ºä¸€ä¸ªå¾®è°ƒä½œä¸šï¼Œä»ç»™å®šçš„æ•°æ®é›†ä¸­å¾®è°ƒæŒ‡å®šæ¨¡å‹ã€‚
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# POST https://api.openai.com/v1/fine-tunes
openai.FineTune.create(training_file="file-XGinujblHPwGLSztz8cPS8XY")
```

**å“åº”**ï¼ˆå“åº”åŒ…æ‹¬å·²å…¥é˜Ÿçš„ä½œä¸šçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¾®è°ƒä½œä¸šçŠ¶æ€å’Œå®Œæˆåå¾®è°ƒæ¨¡å‹çš„åç§°ï¼‰ï¼š
```json
{
  "id": "ft-AF1WoRqd3aJAHsqc9NY7iL8F",
  "object": "fine-tune",
  "model": "curie",
  "created_at": 1614807352,
  "events": [
    {
      "object": "fine-tune-event",
      "created_at": 1614807352,
      "level": "info",
      "message": "Job enqueued. Waiting for jobs ahead to complete. Queue number: 0."
    }
  ],
  "fine_tuned_model": null,
  "hyperparams": {
    "batch_size": 4,
    "learning_rate_multiplier": 0.1,
    "n_epochs": 4,
    "prompt_loss_weight": 0.1,
  },
  "organization_id": "org-...",
  "result_files": [],
  "status": "pending",
  "validation_files": [],
  "training_files": [
    {
      "id": "file-XGinujblHPwGLSztz8cPS8XY",
      "object": "file",
      "bytes": 1547276,
      "created_at": 1610062281,
      "filename": "my-data-train.jsonl",
      "purpose": "fine-tune-train"
    }
  ],
  "updated_at": 1614807352,
}
```

**Request body(å…¥å‚è¯¦è§£)** ï¼š

> - `training_file` ï¼ˆstringï¼Œå¿…å¡«ï¼‰
>
>   åŒ…å« **è®­ç»ƒæ•°æ®** çš„å·²ä¸Šä¼ æ–‡ä»¶çš„IDã€‚
>
>   è¯·å‚é˜… [upload file](https://platform.openai.com/docs/api-reference/files/upload) ä»¥äº†è§£å¦‚ä½•ä¸Šä¼ æ–‡ä»¶ã€‚
>
>   æ•°æ®é›†å¿…é¡»æ ¼å¼åŒ–ä¸º **JSONLæ–‡ä»¶**ï¼Œå…¶ä¸­æ¯ä¸ªè®­ç»ƒç¤ºä¾‹éƒ½æ˜¯ä¸€ä¸ªå¸¦æœ‰ â€œpromptâ€ å’Œ â€œcompletionâ€ keys çš„ JSONå¯¹è±¡ã€‚
>
> - `validation_file` ï¼ˆstringï¼Œé€‰å¡«ï¼‰
>
>   åŒ…å« **éªŒè¯æ•°æ®** çš„å·²ä¸Šä¼ æ–‡ä»¶çš„IDã€‚
>
>   å¦‚æœæä¾›æ­¤æ–‡ä»¶ï¼Œåˆ™æ•°æ®å°†åœ¨å¾®è°ƒæœŸé—´å®šæœŸç”¨äºç”ŸæˆéªŒè¯æŒ‡æ ‡ã€‚è¿™äº›æŒ‡æ ‡å¯ä»¥åœ¨ [å¾®è°ƒç»“æœæ–‡ä»¶](https://platform.openai.com/docs/guides/fine-tuning/analyzing-your-fine-tuned-model) ä¸­æŸ¥çœ‹ï¼Œè®­ç»ƒå’ŒéªŒè¯æ•°æ®åº”è¯¥æ˜¯äº’æ–¥çš„ã€‚
>
> - `model` ï¼ˆstringï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯curieï¼‰
>
>   è¦å¾®è°ƒçš„åŸºç¡€æ¨¡å‹åç§°ã€‚
>
>   å¯ä»¥é€‰æ‹©å…¶ä¸­ä¹‹ä¸€ï¼š"ada"ã€"babbage"ã€"curie"ã€"davinci"ï¼Œæˆ– 2022å¹´4æœˆ21æ—¥ ååˆ›å»ºçš„ç»è¿‡å¾®è°ƒçš„æ¨¡å‹ã€‚è¦äº†è§£è¿™äº›æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [Models](https://platform.openai.com/docs/models) æ–‡æ¡£ã€‚
>
> - `n_epochs` ï¼ˆintegerï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯4ï¼‰
>
>   è®­ç»ƒæ¨¡å‹çš„æ‰¹æ¬¡æ•°ã€‚ä¸€ä¸ª epoch æŒ‡çš„æ˜¯å®Œæ•´åœ°éå†ä¸€æ¬¡è®­ç»ƒæ•°æ®é›†
>
> - `batch_size` ï¼ˆintegerï¼Œé€‰å¡«ï¼‰
>
>   ç”¨äºè®­ç»ƒçš„æ‰¹æ¬¡å¤§å°ï¼ŒæŒ‡çš„æ˜¯æ¯æ¬¡è¿­ä»£ä¸­åŒæ—¶å¤„ç†çš„æ ·æœ¬æ•°é‡ã€‚
>
>   é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰¹æ¬¡å¤§å°å°†åŠ¨æ€é…ç½®ä¸ºè®­ç»ƒé›†ç¤ºä¾‹æ•°é‡çš„çº¦ 0.2ï¼…ï¼Œä¸Šé™ä¸º256ã€‚
>
>   é€šå¸¸ï¼Œå‘ç°è¾ƒå¤§çš„æ‰¹æ¬¡å¤§å°å¯¹äºæ›´å¤§çš„æ•°æ®é›†æ•ˆæœæ›´å¥½ã€‚
>
> - `learning_rate_multiplier` ï¼ˆnumberï¼Œé€‰å¡«ï¼‰
>
>   ç”¨äºè®­ç»ƒçš„å­¦ä¹ ç‡å€å¢å™¨ã€‚å¾®è°ƒå­¦ä¹ ç‡æ˜¯é¢„è®­ç»ƒæ—¶ä½¿ç”¨çš„åŸå§‹å­¦ä¹ ç‡ä¹˜ä»¥æ­¤å€¼å¾—åˆ°çš„ï¼ˆğŸ¤–ï¸å¾®è°ƒå­¦ä¹ ç‡ï¼ˆLearning Rateï¼‰æŒ‡çš„æ˜¯ç¥ç»ç½‘ç»œåœ¨è¿›è¡Œæ¢¯åº¦ä¸‹é™ä¼˜åŒ–ç®—æ³•æ—¶ï¼Œæ¯æ¬¡æ›´æ–°å‚æ•°çš„æ­¥é•¿ã€‚å­¦ä¹ ç‡è¶Šå¤§ï¼Œç¥ç»ç½‘ç»œçš„å‚æ•°æ›´æ–°è¶Šå¿«ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´ä¼˜åŒ–è¿‡ç¨‹ä¸ç¨³å®šç”šè‡³æ— æ³•æ”¶æ•›ï¼›å­¦ä¹ ç‡è¶Šå°ï¼Œç¥ç»ç½‘ç»œçš„å‚æ•°æ›´æ–°è¶Šæ…¢ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´ä¼˜åŒ–è¿‡ç¨‹è¿‡äºç¼“æ…¢æˆ–è€…é™·å…¥å±€éƒ¨æœ€ä¼˜è§£ã€‚ï¼‰
>
>   é»˜è®¤æƒ…å†µä¸‹ï¼Œå­¦ä¹ ç‡çš„å€å¢å™¨ä¸º 0.05ã€0.1 æˆ– 0.2ï¼Œå…·ä½“å–å†³äºæœ€ç»ˆ `batch_size`ï¼ˆè¾ƒå¤§çš„æ‰¹æ¬¡å¤§å°é€šå¸¸ä½¿ç”¨è¾ƒå¤§çš„å­¦ä¹ ç‡æ•ˆæœæ›´å¥½ï¼‰ï¼Œå»ºè®®å°è¯•åœ¨ 0.02 åˆ° 0.2 èŒƒå›´å†…å®éªŒä¸åŒå€¼ä»¥æ‰¾å‡ºäº§ç”Ÿæœ€ä½³ç»“æœçš„å€¼ã€‚
>
> - `prompt_loss_weight` ï¼ˆnumberï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯0.01ï¼‰
>
>   "prompt_loss_weight" æ˜¯æŒ‡åœ¨ä½¿ç”¨ Prompt-based Learningï¼ˆåŸºäºæç¤ºçš„å­¦ä¹ ï¼‰æ–¹æ³•è¿›è¡Œè®­ç»ƒæ—¶ï¼Œç”¨äºè°ƒæ•´æç¤ºæŸå¤±ï¼ˆPrompt Lossï¼‰å¯¹æ€»ä½“æŸå¤±ï¼ˆTotal Lossï¼‰çš„ç›¸å¯¹æƒé‡ã€‚
>
>   Prompt-based Learning æ˜¯ä¸€ç§åˆ©ç”¨äººç±»å…ˆéªŒçŸ¥è¯†æ¥è¾…åŠ©ç¥ç»ç½‘ç»œå­¦ä¹ çš„æ–¹æ³•ï¼Œå…¶ä¸­æç¤ºæŸå¤±æ˜¯æŒ‡åˆ©ç”¨äººç±»å…ˆéªŒçŸ¥è¯†è®¾è®¡çš„æç¤ºï¼ˆPromptï¼‰ä¸æ¨¡å‹ç”Ÿæˆçš„ç»“æœä¹‹é—´çš„æŸå¤±ã€‚
>
>   åœ¨ Prompt-based Learning ä¸­ï¼Œé€šè¿‡è°ƒæ•´ prompt_loss_weight çš„å¤§å°æ¥å¹³è¡¡æ€»ä½“æŸå¤±å’Œæç¤ºæŸå¤±çš„è´¡çŒ®ï¼Œä»è€Œä½¿æ¨¡å‹æ›´å¥½åœ°åˆ©ç”¨äººç±»å…ˆéªŒçŸ¥è¯†è¿›è¡Œé¢„æµ‹ã€‚å¦‚æœ prompt_loss_weight è¾ƒå¤§ï¼Œæ¨¡å‹ä¼šæ›´åŠ ä¾èµ–æç¤ºæŸå¤±ï¼Œæ›´å¥½åœ°åˆ©ç”¨äººç±»å…ˆéªŒçŸ¥è¯†ï¼›å¦‚æœ prompt_loss_weight è¾ƒå°ï¼Œæ¨¡å‹ä¼šæ›´åŠ ä¾èµ–æ€»ä½“æŸå¤±ï¼Œæ›´å¥½åœ°é€‚åº”å½“å‰æ•°æ®é›†çš„ç‰¹å¾å’Œåˆ†å¸ƒã€‚
>
> - `compute_classification_metrics` ï¼ˆbooleanï¼Œé€‰å¡«ï¼Œé»˜è®¤æ˜¯falseï¼‰
>
>   å¦‚æœè®¾ç½®äº†ï¼Œä¼šåœ¨æ¯ä¸ª epoch ç»“æŸæ—¶ä½¿ç”¨éªŒè¯é›†è®¡ç®—ç‰¹å®šäºåˆ†ç±»çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚å‡†ç¡®ç‡å’Œ F-1 åˆ†æ•°ã€‚è¿™äº›æŒ‡æ ‡å¯ä»¥åœ¨ [å¾®è°ƒç»“æœæ–‡ä»¶](https://platform.openai.com/docs/guides/fine-tuning/analyzing-your-fine-tuned-model) ä¸­æŸ¥çœ‹ã€‚ä¸ºäº†è®¡ç®—åˆ†ç±»æŒ‡æ ‡ï¼Œå¿…é¡»æä¾›ä¸€ä¸ª`validation_file(éªŒè¯æ–‡ä»¶)`ã€‚
>
>   æ­¤å¤–ï¼Œå¯¹äºå¤šç±»åˆ†ç±»ï¼Œå¿…é¡»æŒ‡å®š `classification_n_classes`ï¼›å¯¹äºäºŒå…ƒåˆ†ç±»ï¼Œåˆ™éœ€è¦æŒ‡å®š`classification_positive_class`ã€‚
>
> - `suffix` ï¼ˆstringï¼Œé€‰å¡«ï¼Œé»˜è®¤ä¸º nullï¼‰
>
>   ä¸€ä¸ªé•¿åº¦æœ€å¤šä¸º 40ä¸ªå­—ç¬¦ çš„å­—ç¬¦ä¸²ï¼Œå°†è¢«æ·»åŠ åˆ°å¾®è°ƒæ¨¡å‹åç§°ä¸­ã€‚
>
>   ä¾‹å¦‚ï¼Œ`suffix`  ä¸º â€œcustom-model-nameâ€ ä¼šç”Ÿæˆä¸€ä¸ªæ¨¡å‹åç§°ï¼Œå¦‚ `ada:ft-your-org:custom-model-name-2022-02-15-04-21-04`ã€‚


##### **List fine-tunes**
åˆ—å‡ºæ‰€å±ç»„ç»‡ä¸‹çš„å¾®è°ƒä½œä¸šåˆ—è¡¨
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# GET https://api.openai.com/v1/fine-tunes
openai.FineTune.list()
```

**å“åº”** ï¼š
```json
{
  "object": "list",
  "data": [
    {
      "id": "ft-AF1WoRqd3aJAHsqc9NY7iL8F",
      "object": "fine-tune",
      "model": "curie",
      "created_at": 1614807352,
      "fine_tuned_model": null,
      "hyperparams": { ... },
      "organization_id": "org-...",
      "result_files": [],
      "status": "pending",
      "validation_files": [],
      "training_files": [ { ... } ],
      "updated_at": 1614807352,
    },
    { ... },
    { ... }
  ]
}
```

##### **Retrieve fine-tune**
è·å–æœ‰å…³å¾®è°ƒä½œä¸šçš„ä¿¡æ¯
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/fine-tunes/{fine_tune_id}
openai.FineTune.retrieve(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```

**å“åº”** ï¼š
```json
{
  "id": "ft-AF1WoRqd3aJAHsqc9NY7iL8F",
  "object": "fine-tune",
  "model": "curie",
  "created_at": 1614807352,
  "events": [
    {
      "object": "fine-tune-event",
      "created_at": 1614807352,
      "level": "info",
      "message": "Job enqueued. Waiting for jobs ahead to complete. Queue number: 0."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807356,
      "level": "info",
      "message": "Job started."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807861,
      "level": "info",
      "message": "Uploaded snapshot: curie:ft-acmeco-2021-03-03-21-44-20."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Uploaded result files: file-QQm6ZpqdNwAaVC3aSz5sWwLT."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Job succeeded."
    }
  ],
  "fine_tuned_model": "curie:ft-acmeco-2021-03-03-21-44-20",
  "hyperparams": {
    "batch_size": 4,
    "learning_rate_multiplier": 0.1,
    "n_epochs": 4,
    "prompt_loss_weight": 0.1,
  },
  "organization_id": "org-...",
  "result_files": [
    {
      "id": "file-QQm6ZpqdNwAaVC3aSz5sWwLT",
      "object": "file",
      "bytes": 81509,
      "created_at": 1614807863,
      "filename": "compiled_results.csv",
      "purpose": "fine-tune-results"
    }
  ],
  "status": "succeeded",
  "validation_files": [],
  "training_files": [
    {
      "id": "file-XGinujblHPwGLSztz8cPS8XY",
      "object": "file",
      "bytes": 1547276,
      "created_at": 1610062281,
      "filename": "my-data-train.jsonl",
      "purpose": "fine-tune-train"
    }
  ],
  "updated_at": 1614807865,
}
```

##### **Cancel fine-tune**
ç«‹å³å–æ¶ˆå¾®è°ƒå·¥ä½œ
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/fine-tunes/{fine_tune_id}/cancel
openai.FineTune.cancel(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```
**å“åº”** ï¼š
```json
{
  "id": "ft-xhrpBbvVUzYGo8oUO1FY4nI7",
  "object": "fine-tune",
  "model": "curie",
  "created_at": 1614807770,
  "events": [ { ... } ],
  "fine_tuned_model": null,
  "hyperparams": { ... },
  "organization_id": "org-...",
  "result_files": [],
  "status": "cancelled",
  "validation_files": [],
  "training_files": [
    {
      "id": "file-XGinujblHPwGLSztz8cPS8XY",
      "object": "file",
      "bytes": 1547276,
      "created_at": 1610062281,
      "filename": "my-data-train.jsonl",
      "purpose": "fine-tune-train"
    }
  ],
  "updated_at": 1614807789,
}
```

##### **List fine-tune events**
è·å–å¾®è°ƒä½œä¸šå„é˜¶æ®µè¿è¡ŒçŠ¶æ€ï¼ˆäº‹ä»¶ï¼‰è¯¦æƒ…
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/fine-tunes/{fine_tune_id}/events
openai.FineTune.list_events(id="ft-AF1WoRqd3aJAHsqc9NY7iL8F")
```

**å“åº”** ï¼š
```json
{
  "object": "list",
  "data": [
    {
      "object": "fine-tune-event",
      "created_at": 1614807352,
      "level": "info",
      "message": "Job enqueued. Waiting for jobs ahead to complete. Queue number: 0."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807356,
      "level": "info",
      "message": "Job started."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807861,
      "level": "info",
      "message": "Uploaded snapshot: curie:ft-acmeco-2021-03-03-21-44-20."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Uploaded result files: file-QQm6ZpqdNwAaVC3aSz5sWwLT."
    },
    {
      "object": "fine-tune-event",
      "created_at": 1614807864,
      "level": "info",
      "message": "Job succeeded."
    }
  ]
}
```
**Query parameters** ï¼š

> - `stream` ï¼ˆbooleanï¼Œé€‰å¡«ï¼‰
>
>   å¯¹äºå¾®è°ƒä½œä¸šè¿è¡ŒçŠ¶æ€æ˜¯å¦ä»¥äº‹ä»¶æµçš„æ–¹å¼è¿”å›
>
>   å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™ä¼šä¸æ–­åœ°è¾“å‡ºå¾®è°ƒä½œä¸šè¿è¡Œæœ€æ–°çŠ¶æ€ä¿¡æ¯ï¼Œç›´åˆ°å¾®è°ƒä½œä¸šå®Œæˆï¼ˆæˆåŠŸã€å–æ¶ˆæˆ–å¤±è´¥ï¼‰æ—¶ï¼Œä»¥ `dataï¼š[DONE]` æ¶ˆæ¯ç»ˆæ­¢ã€‚
>
>   å¦‚æœè®¾ç½®ä¸º falseï¼Œåˆ™ä»…è¿”å›åˆ°ç›®å‰ä¸ºæ­¢ç”Ÿæˆçš„äº‹ä»¶ã€‚
>

##### **Delete fine-tune model**
åˆ é™¤å¾®è°ƒçš„æ¨¡å‹ï¼ˆå‰ææ˜¯æœ‰æƒé™ï¼‰
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/models/{model}
openai.Model.delete("curie:ft-acmeco-2021-03-03-21-44-20")
```
**å“åº”** ï¼š
```json
{
  "id": "curie:ft-acmeco-2021-03-03-21-44-20",
  "object": "model",
  "deleted": true
}
```
#### Models æ¨¡å‹ç®¡ç†
åˆ—å‡ºå¹¶æè¿° API ä¸­å¯ç”¨çš„å„ç§æ¨¡å‹ï¼Œå¯ä»¥å‚è€ƒ [æ¨¡å‹æ–‡æ¡£](https://platform.openai.com/docs/models) ä»¥äº†è§£å¯ç”¨çš„æ¨¡å‹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å·®å¼‚ã€‚

##### **åˆ—å‡ºæ¨¡å‹**

åˆ—å‡ºå½“å‰å¯ç”¨çš„æ¨¡å‹ï¼Œå¹¶æä¾›æœ‰å…³æ¯ä¸ªæ¨¡å‹çš„åŸºæœ¬ä¿¡æ¯ï¼Œä¾‹å¦‚æ‰€æœ‰è€…å’Œå¯ç”¨æ€§ã€‚
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/models
openai.Model.list()
```

**å“åº”**
ï¼š

```json
{
  "data": [
    {
      "id": "model-id-0",
      "object": "model",
      "owned_by": "organization-owner",
      "permission": [...]
    },
    {
      "id": "model-id-1",
      "object": "model",
      "owned_by": "organization-owner",
      "permission": [...]
    },
    {
      "id": "model-id-2",
      "object": "model",
      "owned_by": "openai",
      "permission": [...]
    },
  ],
  "object": "list"
}
```

##### **æ£€ç´¢æ¨¡å‹è¯¦æƒ…**
æ£€ç´¢æ¨¡å‹å®ä¾‹ï¼Œæä¾›æœ‰å…³æ¨¡å‹çš„åŸºæœ¬ä¿¡æ¯ï¼Œä¾‹å¦‚æ‰€æœ‰è€…å’Œæƒé™ã€‚å…¶ä¸­ï¼Œ`model` ä¸ºå¿…å¡«çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œç”¨äºæ­¤è¯·æ±‚çš„æ¨¡å‹çš„ IDã€‚
```python
import os
import openai
openai.api_key = os.getenv("OPENAI_API_KEY")
# https://api.openai.com/v1/models/{model}
openai.Model.retrieve("text-davinci-003")
```

**å“åº”** ï¼š

```json
{
  "id": "text-davinci-003",
  "object": "model",
  "owned_by": "openai",
  "permission": [...]
}
```

#### å…¶ä»–
- [Images å›¾åƒ](https://platform.openai.com/docs/api-reference/images)ï¼ˆå›¾åƒç”ŸæˆAPIï¼ŒDALLÂ·Eçš„èƒ½åŠ›å·²ç»è½åäºStable Diffusionå’ŒMidjourneyï¼Œä½¿ç”¨åœºæ™¯ä¸å¤šï¼‰
- [Audio éŸ³é¢‘](https://platform.openai.com/docs/api-reference/audio)ï¼ˆéŸ³é¢‘è½¬æ¢ä¸ºæ–‡æœ¬APIï¼ŒWhisperæ¨¡å‹å·²ç»å¼€æºï¼Œå¯ä»¥æœ¬åœ°æ­å»ºä½¿ç”¨ï¼‰
- [Files æ–‡ä»¶](https://platform.openai.com/docs/api-reference/files)ï¼ˆä¸Šä¼ æ–‡æ¡£APIï¼Œä¸€èˆ¬ä¸å¾®è°ƒç­‰åŠŸèƒ½ä¸€èµ·ä½¿ç”¨ï¼Œä¸éœ€è¦ä¸“é—¨å…³æ³¨ï¼‰
- [Edits ç¼–è¾‘](https://platform.openai.com/docs/api-reference/edits)ï¼ˆæ›´æ–°æç¤ºè¯APIï¼Œå¯¹è¯è¡¥å…¨æ¥å£å·²ç»è¦†ç›–äº†ï¼‰
- [Moderations å®¡æ ¸](https://platform.openai.com/docs/api-reference/fine-tunes/delete-model) (å†…å®¹å®¡æ ¸APIï¼Œå¦‚æœæ¨¡å‹è¯†åˆ«åˆ°æç¤ºè¯è¿åäº†OpenAIçš„å†…å®¹ç­–ç•¥ï¼Œä¼šè¿”å›å®¡æ ¸ä¿¡æ¯è¯¦æƒ…)
- Parameter details å‚æ•°ç»†èŠ‚ï¼ˆæ²¡æœ‰ä½¿ç”¨è¿‡ï¼‰

### å¾®è°ƒï¼ˆFine-tuningï¼‰

### åµŒå…¥ï¼ˆEmbeddingsï¼‰
#### æ–‡æœ¬åµŒå…¥æ˜¯ä»€ä¹ˆ
å‘é‡æ˜¯ä¸€ä¸ªæœ‰æ–¹å‘å’Œé•¿åº¦çš„é‡ï¼Œå¯ä»¥ç”¨æ•°å­¦ä¸­çš„åæ ‡æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨äºŒç»´åæ ‡ç³»ä¸­çš„å‘é‡è¡¨ç¤ºä¸€ä¸ªå¹³é¢ä¸Šçš„ç‚¹ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸‰ç»´åæ ‡ç³»ä¸­çš„å‘é‡è¡¨ç¤ºä¸€ä¸ªç©ºé—´ä¸­çš„ç‚¹ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå‘é‡é€šå¸¸ç”¨äºè¡¨ç¤ºæ•°æ®çš„ç‰¹å¾ã€‚

è€Œæ–‡æœ¬åµŒå…¥æ˜¯ä¸€ç§å°†æ–‡æœ¬è¿™ç§ç¦»æ•£æ•°æ®æ˜ å°„åˆ°è¿ç»­å‘é‡ç©ºé—´çš„æ–¹æ³•ï¼ŒåµŒå…¥æŠ€æœ¯å¯ä»¥å°†é«˜ç»´çš„ç¦»æ•£æ•°æ®é™ç»´åˆ°ä½ç»´çš„è¿ç»­ç©ºé—´ä¸­ï¼Œå¹¶ä¿ç•™æ•°æ®ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼Œä»è€Œæ–¹ä¾¿è¿›è¡Œæœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„ä»»åŠ¡ã€‚

ä¾‹å¦‚ï¼š  
> "æœºå™¨å­¦ä¹ "è¡¨ç¤ºä¸º [1,2,3]   
 "æ·±åº¦å­¦ä¹ "è¡¨ç¤ºä¸º[2,3,3]  
 "è‹±é›„è”ç›Ÿ"è¡¨ç¤ºä¸º[9,1,3]
>
> ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆä½™å¼¦ç›¸ä¼¼åº¦æ˜¯ä¸€ç§ç”¨äºè¡¡é‡å‘é‡ä¹‹é—´ç›¸ä¼¼åº¦çš„æŒ‡æ ‡ï¼Œå¯ä»¥ç”¨äºæ–‡æœ¬åµŒå…¥ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼‰åœ¨è®¡ç®—æœºä¸­æ¥åˆ¤æ–­æ–‡æœ¬ä¹‹é—´çš„è·ç¦»ï¼š 

> â€œæœºå™¨å­¦ä¹ â€ä¸â€œæ·±åº¦å­¦ä¹ â€çš„è·ç¦»ï¼š![](https://private.codecogs.com/gif.latex?cos%28%5CTheta_1%20%29%3D%5Cfrac%7B1*2+2*3+3*3%7D%7B%5Csqrt%7B1%5E2+2%5E2+3%5E3%7D%5Csqrt%7B2%5E2+3%5E2+3%5E3%7D%7D%3D0.97)
> 
> "æœºå™¨å­¦ä¹ â€ä¸â€œè‹±é›„è”ç›Ÿâ€œçš„è·ç¦»"ï¼š![](https://private.codecogs.com/gif.latex?cos%28%5CTheta_2%20%29%3D%5Cfrac%7B1*9+2*1+3*3%7D%7B%5Csqrt%7B1%5E2+2%5E2+3%5E3%7D%5Csqrt%7B9%5E2+1%5E2+3%5E3%7D%7D%3D0.56)
> 
> â€œæœºå™¨å­¦ä¹ â€ä¸â€œæ·±åº¦å­¦ä¹ â€ä¸¤ä¸ªæ–‡æœ¬ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦æ›´é«˜ï¼Œè¡¨ç¤ºå®ƒä»¬åœ¨è¯­ä¹‰ä¸Šæ›´ç›¸ä¼¼ã€‚

#### æ–‡æœ¬åµŒå…¥ç®—æ³•
æ–‡æœ¬åµŒå…¥ç®—æ³•æ˜¯æŒ‡å°†æ–‡æœ¬æ•°æ®è½¬åŒ–ä¸ºå‘é‡è¡¨ç¤ºçš„å…·ä½“ç®—æ³•ï¼Œé€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š
- åˆ†è¯ï¼šå°†æ–‡æœ¬åˆ’åˆ†æˆä¸€ä¸ªä¸ªå•è¯æˆ–çŸ­è¯­ã€‚
- æ„å»ºè¯æ±‡è¡¨ï¼šå°†åˆ†è¯åçš„å•è¯æˆ–çŸ­è¯­å»ºç«‹è¯æ±‡è¡¨ï¼Œå¹¶ä¸ºæ¯ä¸ªå•è¯æˆ–çŸ­è¯­èµ‹äºˆä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ã€‚
- è®¡ç®—è¯åµŒå…¥ï¼šä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹æˆ–è‡ªè¡Œè®­ç»ƒçš„æ¨¡å‹ï¼Œå°†æ¯ä¸ªå•è¯æˆ–çŸ­è¯­æ˜ å°„åˆ°å‘é‡ç©ºé—´ä¸­ã€‚
- è®¡ç®—æ–‡æœ¬åµŒå…¥ï¼šå°†æ–‡æœ¬ä¸­æ¯ä¸ªå•è¯æˆ–çŸ­è¯­çš„å‘é‡è¡¨ç¤ºå–å¹³å‡æˆ–åŠ æƒå¹³å‡ï¼Œå¾—åˆ°æ•´ä¸ªæ–‡æœ¬çš„å‘é‡è¡¨ç¤ºã€‚

å¸¸è§çš„æ–‡æœ¬åµŒå…¥ç®—æ³•åŒ…æ‹¬ Word2Vecã€GloVeã€FastText ç­‰ã€‚è¿™äº›ç®—æ³•é€šè¿‡é¢„è®­ç»ƒæˆ–è‡ªè¡Œè®­ç»ƒçš„æ–¹å¼ï¼Œå°†å•è¯æˆ–çŸ­è¯­æ˜ å°„åˆ°ä½ç»´å‘é‡ç©ºé—´ä¸­ï¼Œä»è€Œèƒ½å¤Ÿåœ¨è®¡ç®—æœºä¸­æ–¹ä¾¿åœ°å¤„ç†æ–‡æœ¬æ•°æ®ã€‚
#### æ–‡æœ¬åµŒå…¥ç”¨é€”
æ–‡æœ¬åµŒå…¥ç”¨äºæµ‹é‡æ–‡æœ¬å­—ç¬¦ä¸²çš„ç›¸å…³æ€§ï¼Œé€šå¸¸ç”¨äºï¼š
- æœç´¢ï¼ˆç»“æœæŒ‰ä¸æŸ¥è¯¢å­—ç¬¦ä¸²çš„ç›¸å…³æ€§æ’åºï¼‰
- èšç±»ï¼ˆå…¶ä¸­æ–‡æœ¬å­—ç¬¦ä¸²æŒ‰ç›¸ä¼¼æ€§åˆ†ç»„ï¼‰
- æ¨èï¼ˆæ¨èå…·æœ‰ç›¸å…³æ–‡æœ¬å­—ç¬¦ä¸²çš„é¡¹ç›®ï¼‰
- å¼‚å¸¸æ£€æµ‹ï¼ˆè¯†åˆ«å‡ºç›¸å…³æ€§å¾ˆå°çš„å¼‚å¸¸å€¼ï¼‰
- å¤šæ ·æ€§æµ‹é‡ï¼ˆåˆ†æç›¸ä¼¼æ€§åˆ†å¸ƒï¼‰
- åˆ†ç±»ï¼ˆå…¶ä¸­æ–‡æœ¬å­—ç¬¦ä¸²æŒ‰å…¶æœ€ç›¸ä¼¼çš„æ ‡ç­¾åˆ†ç±»ï¼‰

#### ä½¿ç”¨æ–‡æœ¬åµŒå…¥æ¨¡å‹
* å¯ä»¥ä½¿ç”¨ HuggingFaceä¸Šèƒ½å¤Ÿå¤„ç†æ–‡æœ¬åµŒå…¥çš„å¼€æºæ¨¡å‹ï¼Œä¾‹å¦‚ï¼š[uer/sbert-base-chinese-nli](https://huggingface.co/uer/sbert-base-chinese-nli)
  ```python
  from sentence_transformers import SentenceTransformer
  model = SentenceTransformer('uer/sbert-base-chinese-nli')
  sentences = ["æœºå™¨å­¦ä¹ ","æ·±åº¦å­¦ä¹ ","è‹±é›„è”ç›Ÿ",]
  sentence_embeddings = model.encode(sentences)
  ```

* ä½¿ç”¨ä¹‹å‰ä»‹ç»çš„ [OpenAI æ–‡æœ¬åµŒå…¥API](#embeddings) å¯ä»¥å°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡ï¼ŒOpenAI APIæä¾›äº†å¤šä¸ªæ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œ[è¿™ç¯‡åšå®¢](https://openai.com/blog/new-and-improved-embedding-mode)å¯¹å®ƒä»¬çš„æ€§èƒ½è¿›è¡Œäº†æ¯”è¾ƒï¼Œè¿™é‡Œæ˜¯æ€§èƒ½æœ€å¥½çš„`text-embedding-ada-002`è¯´æ˜ï¼š

  | æ¨¡å‹åç§°               | ä»·æ ¼                     | åˆ†è¯å™¨       | æœ€å¤§è¾“å…¥ token | è¾“å‡º |
  | ---------------------- | ------------------------ | ------------ | -------------- | ---- |
  | text-embedding-ada-002 | 1000 token/0.0004ç¾å…ƒ | cl100k_base  | 8191           | 1536 |

* ä½¿ç”¨[tiktoken](https://github.com/openai/tiktoken) è®¡ç®—åŸå§‹å­—ç¬¦ä¸²å¯¹åº”çš„ token æ•°ã€‚
  ```python
  import tiktoken

  def num_tokens_from_string(string: str, encoding_name: str) -> int:
      """Returns the number of tokens in a text string."""
      encoding = tiktoken.get_encoding(encoding_name)
      num_tokens = len(encoding.encode(string))
      return num_tokens

  num_tokens_from_string("tiktoken is great!", "cl100k_base")
  ```
#### çŸ¢é‡æ•°æ®åº“
* ä¸ºäº†å¿«é€Ÿæœç´¢å¤šä¸ªçŸ¢é‡ï¼Œå»ºè®®ä½¿ç”¨çŸ¢é‡æ•°æ®åº“ï¼Œä¸‹é¢æ˜¯ä¸€äº›å¯é€‰çš„çŸ¢é‡æ•°æ®åº“ï¼š
  - [Pinecone](https://github.com/openai/openai-cookbook/tree/main/examples/vector_databases/pinecone)ï¼Œä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„çŸ¢é‡æ•°æ®åº“
  - [Weaviate](https://github.com/openai/openai-cookbook/tree/main/examples/vector_databases/weaviate)ï¼Œä¸€ä¸ªå¼€æºçš„çŸ¢é‡æœç´¢å¼•æ“
  - [Redis](https://github.com/openai/openai-cookbook/tree/main/examples/vector_databases/redis)ä½œä¸ºçŸ¢é‡æ•°æ®åº“
  - [Qdrant](https://github.com/openai/openai-cookbook/tree/main/examples/vector_databases/qdrant)ï¼Œä¸€ä¸ªçŸ¢é‡æœç´¢å¼•æ“
  - [Milvus](https://github.com/openai/openai-cookbook/blob/main/examples/vector_databases/Using_vector_databases_for_embeddings_search.ipynb)ï¼Œä¸€ä¸ªä¸ºå¯æ‰©å±•çš„ç›¸ä¼¼æ€§æœç´¢è€Œæ„å»ºçš„çŸ¢é‡æ•°æ®åº“
  - [Chroma](https://github.com/chroma-core/chroma)ï¼Œä¸€ä¸ªå¼€æºåµŒå…¥å¼å•†åº—
  - [Typesense](https://typesense.org/docs/0.24.0/api/vector-search.html)ï¼Œå¿«é€Ÿçš„å¼€æºçŸ¢é‡æœç´¢å¼•æ“
  - [Zilliz](https://github.com/openai/openai-cookbook/tree/main/examples/vector_databases/zilliz)ï¼Œæ•°æ®åŸºç¡€è®¾æ–½ï¼Œç”±Milvusæä¾›æŠ€æœ¯æ”¯æŒ
  - [FAISS](https://github.com/facebookresearch/faiss) æ˜¯Metaå¼€æºçš„ç”¨äºé«˜æ•ˆæœç´¢å¤§è§„æ¨¡çŸ¢é‡æ•°æ®é›†çš„åº“
* æ€§èƒ½âœï¸ï¼šå’Œä¼ ç»Ÿæ•°æ®åº“ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨å·¥ç¨‹æ‰‹æ®µä¼˜åŒ–çŸ¢é‡æ•°æ®åº“æœç´¢æ€§èƒ½ï¼Œæœ€ç›´æ¥çš„å°±æ˜¯æ›´æ–°ç´¢å¼•ç®—æ³• ï¼Œå¯¹ç´¢å¼•æ•°æ®è¿›è¡Œåˆ†åŒºä¼˜åŒ–ï¼Œå°†æ•°æ®é€šè¿‡â€œæ²ƒç½—è¯ºä¼Šå›¾å•å…ƒâ€ï¼ˆä¹Ÿè¢«å«åšæ³°æ£®å¤šè¾¹å½¢ï¼‰æ¥è¿›è¡Œåˆ‡å‰²ï¼ˆç±»ä¼¼ä¼ ç»Ÿæ•°æ®åº“åˆ†åº“åˆ†è¡¨ï¼‰ã€‚
1. å¹³é¢ç´¢å¼•ï¼ˆFLATï¼‰

- å«ä¹‰ï¼šå°†å‘é‡ç®€å•åœ°å­˜å‚¨åœ¨ä¸€ä¸ªå¹³é¢ç»“æ„ä¸­ï¼Œæœ€åŸºæœ¬çš„å‘é‡ç´¢å¼•æ–¹æ³•ã€‚
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$
- ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆCosine Similarityï¼‰ï¼š$sim(x,y) = \frac{x \cdot y}{\|x\| \|y\|}$

2. åˆ†åŒºç´¢å¼•ï¼ˆIVFï¼‰

- å«ä¹‰ï¼šå°†å‘é‡åˆ†é…åˆ°ä¸åŒçš„åˆ†åŒºä¸­ï¼Œæ¯ä¸ªåˆ†åŒºå»ºç«‹ä¸€ä¸ªå€’æ’ç´¢å¼•ç»“æ„ï¼Œæœ€ç»ˆé€šè¿‡å€’æ’ç´¢å¼•å®ç°ç›¸ä¼¼åº¦æœç´¢ã€‚
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$
- ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆCosine Similarityï¼‰ï¼š$sim(x,y) = \frac{x \cdot y}{\|x\| \|y\|}$

3. é‡åŒ–ç´¢å¼•ï¼ˆPQï¼‰

- å«ä¹‰ï¼šå°†é«˜ç»´å‘é‡åˆ’åˆ†æˆè‹¥å¹²å­å‘é‡ï¼Œå°†æ¯ä¸ªå­å‘é‡é‡åŒ–ä¸ºä¸€ä¸ªç¼–ç ï¼Œæœ€ç»ˆå°†ç¼–ç å­˜å‚¨åœ¨å€’æ’ç´¢å¼•ä¸­ï¼Œåˆ©ç”¨å€’æ’ç´¢å¼•è¿›è¡Œç›¸ä¼¼åº¦æœç´¢ã€‚
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$
- æ±‰æ˜è·ç¦»ï¼ˆHamming Distanceï¼‰ï¼š$d(x,y) = \sum_{i=1}^n (x_i \oplus y_i)$ï¼Œå…¶ä¸­ $\oplus$ è¡¨ç¤ºæŒ‰ä½å¼‚æˆ–æ“ä½œã€‚

4. HNSW (Hierarchical Navigable Small World)

- å«ä¹‰ï¼šé€šè¿‡æ„å»ºä¸€æ£µå±‚æ¬¡åŒ–çš„å›¾ç»“æ„ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„ç›¸ä¼¼åº¦æœç´¢ã€‚
- å†…ç§¯ï¼ˆInner Productï¼‰ï¼š$sim(x,y) = x \cdot y$
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$

5. NSG (Navigating Spreading-out Graph)

- å«ä¹‰ï¼šé€šè¿‡æ„å»ºä¸€ä¸ªåˆ†å±‚çš„æ— å‘å›¾æ¥å®ç°å¿«é€Ÿçš„ç›¸ä¼¼åº¦æœç´¢ã€‚
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$

6. Annoy (Approximate Nearest Neighbors Oh Yeah)

- å«ä¹‰ï¼šé€šè¿‡å°†é«˜ç»´ç©ºé—´çš„å‘é‡æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼Œå¹¶æ„å»ºä¸€æ£µäºŒå‰æ ‘æ¥å®ç°é«˜æ•ˆçš„è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ã€‚
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$
- æ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan Distanceï¼‰ï¼š$d(x,y) = \sum_{i=1}^n |x_i - y_i|$

7. LSH (Locality-Sensitive Hashing)

- å«ä¹‰ï¼šé€šè¿‡ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†é«˜ç»´çš„å‘é‡æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼Œå¹¶åœ¨ä½ç»´ç©ºé—´ä¸­æ¯”è¾ƒå“ˆå¸Œæ¡¶ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå®ç°é«˜æ•ˆçš„ç›¸ä¼¼åº¦æœç´¢ã€‚
- å†…ç§¯ï¼ˆInner Productï¼‰ï¼š$sim(x,y) = x \cdot y$
- æ¬§å¼è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š$d(x,y) = \sqrt{\sum_{i=1}^n (x_i - y_i)^2}$


### GPT æœ€ä½³å®è·µ

#### æœ€ä½³å®‰å…¨å®è·µ

#### æœ€ä½³ç”Ÿäº§å®è·µ

### å‚è€ƒé“¾æ¥
1. [OpenAI æ–‡æ¡£](https://platform.openai.com/docs/introduction)
2. [OpenAI Cookbook](https://github.com/openai/openai-cookbook)ï¼šåˆ†äº«äº†ä½¿ç”¨OpenAI APIå®Œæˆå¸¸è§ä»»åŠ¡çš„ç¤ºä¾‹ä»£ç 

